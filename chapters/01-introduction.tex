\section{Introduction}
Android is the dominant mobile operating system and acts as a primary gateway to digital world for billions of users. It's crucial for core OS to be a reliable, stable and trustworthy platform, that allows users to run apps and services of their choice. While mobile app privacy has been widely studied \cite{appDataCollection1,appDataCollection2,appDataCollection3,appDataCollection4}, less attention is typically paid to the operating system layer and to privileged service frameworks that silently enable additional functionality. Standard unprivileged apps are constrained by Android's permission model, although some attempt to circumvent it in creative ways \cite{appDataCollection5Circumvention,appDataCollection6Circumvention}. In contrast, privileged system apps operate with higher access to the device and OS, which makes them harder to understand and control. Most user-facing privacy controls focus on applications and permissions, yet a substantial amount of data exchange can occur below the app layer, through OS services, vendor components, and Google service frameworks. This work therefore compares the network behavior of multiple Android distributions and their preinstalled/privileged system components under controlled, reproducible conditions.

\subsection{Android dependency on privacy-threatening services}
While Android’s core is the Android Open Source Project (AOSP), most consumer devices ship with additional proprietary components layered on top. They are often implemented as privileged system apps and service frameworks to provide baseline functionality such as push notifications, location assistance, app distribution/updates, device integrity checks and many more. Users and app developers commonly assume their presence and availability by default. 

These components exists for a practical reason. Centralized services can significantly improve usability and efficiency, for example by reducing battery drain compared to per‑app background connections, and by providing faster, more accurate location through fused network and sensor-based methods. However, this design also tightly couples many functions into a single service stack, so enabling useful capabilities may implicitly enable others that a user would not choose, such as advertising identifiers, telemetry, and behavioral tracking. In practice, the result is a large proprietary bundle that is difficult to audit and decompose into only the features a user actually wants.

On Android, these baseline capabilities are most commonly delivered through GMS (Google Mobile Services). Because Google’s business model is strongly advertising-driven, many users may be unwilling to entrust this provider with broad access to device and their data. In principle, users should be able to choose which services they rely on and have confidence that these choices are enforced by the platform’s permission and isolation mechanisms. This demand for transparency and controllability motivates alternative approaches such as microG and GrapheneOS sandboxed Google Play. These solutions aim to preserve device functionality and app compatibility while reducing privilege and improving user control over Google-related components.

\subsection{Privacy-focused Android operating systems}
Privacy-focused Android operating systems (also referred to as \emph{custom ROMs}) are distributions derived from AOSP that aim to reduce data exposure at the OS level. They achieve this by limiting preinstalled privileged components, tightening default settings, and providing more transparent controls over permissions and network access. In contrast to \emph{stock Android} (the factory system shipping with Google Mobile Services enabled by default) privacy-oriented systems minimize background communication, restrict persistent identifiers, and strengthen user enforcement mechanisms over non-essential components.

In this work we focus on three representative approaches. GrapheneOS prioritizes a hardened security model and strong isolation. Google components are not included by default, but can be installed in a dedicated sandboxed mode as ordinary apps, without the special privileges that Google Mobile Services (GMS) typically hold on factory systems. This design targets improved containment and user control while preserving high compatibility when the user decides to install Google services. GrapheneOS also improves low-level security, for example by replacing Android’s default memory allocator with its own hardened implementation to make memory corruption exploitation harder \cite{graphene-hardened}.

LineageOS provides a lightweight, broadly supported AOSP-based system with minimal preinstalled software and extensive device compatibility. It can be deployed in multiple configurations: without Google services, with official proprietary Google Play Services and Play Store (Gapps), or with microG as an open-source reimplementation of key Google APIs. These configurations represent different trade-offs between privacy, compatibility, and reliance on proprietary services. 

Finally, iod\'eOS is a privacy-oriented distribution based on LineageOS that combines a de-Googled baseline with additional privacy features and preconfigured app ecosystem choices, shipping with microG. For completeness, CalyxOS and /e/OS follow a similar privacy-oriented direction (AOSP-based, microG-enabled, and designed for practical daily use). They were considered for the study, but were excluded because they did not receive updates to the current Android version during the measurement period.

Privacy-focused Android operating systems do not uniformly improve security. Some strengthen the platform through tighter defaults, hardening, and timely patching, while others may weaken it through slower updates or changes that reduce the strength of certain platform guarantees. In particular, microG support often requires signature spoofing, which weakens Android’s signature-based authenticity checks. Systems that enable it typically try to minimize the risk by restricting spoofing to just microG. Some distributions do not support verified boot chain or re-locking the bootloader after installation, which weakens protection against physical tampering.

\subsection{Challenges of network traffic analysis on Android}
Network traffic analysis on Android is difficult by design and that is largely a security benefit. Modern protocols increasingly hide data behind encryption (TLS 1.3, QUIC/HTTP3, encrypted DNS). Even when traffic is captured, compression and binary encodings can make payloads hard to interpret without schemas or additional context. As a result, MITM-based decryption is inherently incomplete. Certificate pinning and anti-tamper mechanisms can block interception or break app functionality. Circumvention of these security mechanisms do not reliably yield a full plaintext view. While emulator-based setups enable highly reproducible traffic capture \cite{parrot2025}, this work uses a physical device to analyze behavior in a real environment, at the cost of reduced control and reproducibility. We accept that some flows will remain opaque, not all network communication will be revealed or understood. Our focus in on differences between studied Android systems and on general patterns.

In this work we captured traffic using a controlled man-in-the-middle gateway around a physical device. A Linux host acted as the Wi‑Fi router and transparently redirected the device’s HTTP(S) traffic through an intercepting proxy, while QUIC over UDP/443 was blocked to force TCP where decryption is feasible. To enable TLS inspection, the proxy CA was installed and promoted to a system-trusted certificate on the device (requiring root access). Where certificate pinning prevented interception, we attempted runtime unpinning via dynamic instrumentation, acknowledging that this only worked for a subset of apps. Full packet captures were recorded and compared across Android distributions to analyze differences in network communication.
